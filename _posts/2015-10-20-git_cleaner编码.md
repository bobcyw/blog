---
layout: Blog Template for Bootstrap
title: git_cleaner编码
excerpt: 简要介绍一下编程流程
---
![github](/blog/pic/github.jpeg)[github](https://github.com/bobcyw/git_cleaner)

## 构造顺序

先定义数据,再定义程序,先写一个从用户角度来表达的yaml,然后对其解析编码.  

## 单元测试

最早按照配置文件里一个关键词对应一个函数动作的编码方式,但在后来的测试中,有时需要提取动作执行的中间状态,来找bug的原因,而增加额外的接口又不是太好的选择,于是根据数据,把函数动作归结到特定数据对象里,再在特定的数据对象中保存相关动作执行的中间状态.

## 元语  

从设计中可以看出,配置文件可能包含子配置文件的可能,所以对于树存在一个遍历过程,于是定义适当的操作元语,对数据处理进行正交分解.

得到如下元语:

* 遍历数据  
* 对某个数据进行指定操作,即算子

## 接口选型

对于git的操作,虽然有特定的python库<sup>[pygit2](https://github.com/libgit2/pygit2)</sup>可以调用,但通过Popen的方式,用命令行调用,相对学习成本更小,两者等价.从发展的角度看,命令行调用也能扩展成远程调用.  
